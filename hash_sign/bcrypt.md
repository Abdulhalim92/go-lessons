# Хэширование с использованием bcrypt

**`bcrypt`** — это алгоритм хэширования, специально разработанный для хэширования
паролей. В отличие от обычных алгоритмов хэширования, таких как MD5 или SHA-256, 
`bcrypt` учитывает фактор времени и вычислительных ресурсов, что делает его более
устойчивым к атакам методом перебора (brute-force) и атакам по словарю.

## Особенности bcrypt

- **Медленное хэширование**: `bcrypt` намеренно выполняет процесс хэширования 
медленно. Это означает, что для генерации и проверки хэшей требуется больше времени,
что затрудняет злоумышленникам попытки подбора паролей.

- **Использование соли**: `bcrypt` автоматически генерирует случайную "соль" 
(добавочный случайный набор данных) при каждом хэшировании, что предотвращает
использование заранее вычисленных таблиц (так называемых "радужных таблиц") для
подбора паролей.

- **Устойчивость к атакам по времени**: `bcrypt` имеет встроенные защиты от атак 
по времени (timing attacks).

- **Параметрируемая сложность (cost factor)**: Параметр сложности (`cost`) 
определяет количество итераций, используемых при хэшировании пароля. Чем выше 
значение `cost`, тем медленнее выполняется хэширование, что увеличивает 
безопасность, но требует больше вычислительных ресурсов.

## Реализация bcrypt в Go

Go предоставляет встроенную библиотеку `golang.org/x/crypto/bcrypt` для работы с
`bcrypt`. Эта библиотека делает процесс хэширования и проверки паролей достаточно 
простым.

### Пример кода для хэширования и проверки паролей на Go

Установите библиотеку `bcrypt`, если она еще не установлена:

```bash
go get golang.org/x/crypto/bcrypt
```

## Пример кода для хэширования и проверки паролей на Go

Используйте следующий пример кода для хэширования пароля и его последующей проверки:

```go
package main

import (
	"fmt"
	"golang.org/x/crypto/bcrypt"
)

// Функция для хэширования пароля с использованием bcrypt
func hashPassword(password string) (string, error) {
	// Параметр cost определяет сложность алгоритма (по умолчанию 10, можно 
	// увеличить для большей безопасности)
	cost := 10
	hashedPassword, err := bcrypt.GenerateFromPassword([]byte(password), cost)
	if err != nil {
		return "", err
	}
	return string(hashedPassword), nil
}

// Функция для проверки пароля
func checkPassword(hashedPassword, password string) bool {
	err := bcrypt.CompareHashAndPassword([]byte(hashedPassword), []byte(password))
	return err == nil
}

func main() {
	// Пример использования
	password := "mysecretpassword"

	// Хэшируем пароль
	hashedPassword, err := hashPassword(password)
	if err != nil {
		fmt.Println("Ошибка хэширования пароля:", err)
		return
	}

	fmt.Println("Хэшированный пароль:", hashedPassword)

	// Проверяем пароль
	isCorrect := checkPassword(hashedPassword, password)
	if isCorrect {
		fmt.Println("Пароль верный!")
	} else {
		fmt.Println("Пароль неверный!")
	}
}
```

### Объяснение кода

- **Хэширование пароля**: Функция `hashPassword` принимает строку с паролем и 
использует метод `bcrypt.GenerateFromPassword` для его хэширования. Параметр
`cost` определяет сложность алгоритма. Рекомендуется использовать значение по 
умолчанию (10) или выше для дополнительной безопасности.

- **Проверка пароля**: Функция `checkPassword` принимает хэшированный пароль и 
вводимый пользователем пароль, а затем использует метод 
`bcrypt.CompareHashAndPassword` для их сравнения. Если пароли совпадают,
функция возвращает `true`.

### Параметр Cost

Параметр `cost` является важным фактором для безопасности. Чем выше значение,
тем больше времени требуется для выполнения хэширования, что делает атаку 
методом перебора более трудоемкой. Однако нужно учитывать баланс между 
безопасностью и производительностью: слишком высокое значение может замедлить
систему.

### Заключение

Использование `bcrypt` для хэширования паролей в Go обеспечивает высокий уровень 
безопасности, защищая от множества видов атак. Благодаря встроенной библиотеке,
использование `bcrypt` в Go-приложениях становится простым и эффективным способом
для безопасного управления паролями.
